<html>
<body>
<img src = "https://im0-tub-ru.yandex.net/i?id=bba6482805a4d1f1d4fd6b68bd12e16b-l&n=13">
<script>
		let canvas = document.getElementById('lab03');
		let ctx = canvas.getContext('2d);
		let canvas1 = document.getElementById('border');
		let ctx1 = canvas1.getContext('2d');

		let img = new Image();
		img.crossOrigin = '';
		img.src = "https://im0-tub-ru.yandex.net/i?id=bba6482805a4d1f1d4fd6b68bd12e16b-l&n=13";
		ing.onload=function (){
				ctx.drawImage (img, -350, -50);
		}
		
//		ctx.fillRect(10, 10, 10, 10);
		canvas.addEventListener('click', Sobel);
		function Sobel() {
				let ch = canvas.height;
				let cw = canvas.width;
				let imgdata = ctx.getImageData(0, 0, cw, ch);
				let imgarray = imgdata.data;
				let img2data = ctx1.getImageData(0, 0, cw, ch);
				for (let i=1; i<ch-1; i++) {
						for (let j=1; j<cw-1; j++) {
								let color = 1;
								let z7 = imgarray[((i+1)*cw+j-1)*4 + color];
								let z8 = imgarray[((i+1)*cw+j)*4 + color];
								let z9 = imgarray[((i+1)*cw+j+1)*4 + color];
								let z4 = ingarray[(i*cw+j-1)*4 + color];
								let z5 = ingarray[(i*cw+j)*4 + color];
								let z6 = ingarray[(i*cw+j+1)*4 + color];
								let z1 = imgarray[((i-1)*cw+j-1)*4 + color];
								let z2 = imgarray[((i-1)*cw+j)*4 + color];
								let z3 = imgarray[((i-1)*cw+j+1)*4 + color];
								let Gx = (z7+2*z8+z9)-(z1+2*z2+z3);
								let Gy = (z3+2*z6+z9)-(z1+2*z4+z7);
//								let Gx = (3*z7+10*z8+3*z9)-(3*z1+10*z2+3*z3);
//								let Gy = (3*z3+10*z6+3*z9)-(3*z1+10*z4+3*z7);
								let G = Math.sqrt(Gx*Gx+Gy*Gy);
								if (G>0) {
										img2data.data[(i*cw+j)*4+3]=G;
								}
						}
						ctx1.putImageData(img2data, 0, 0);
				}
		}
</script>
</body>
</html>
